setwd(paste0('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP/input/', region, '/no-SO4/diff'))
# Read in csv files and bind into single data frame
target_filename <- list.files(getwd(), "*.csv")
no_so4 <- bind_rows(map(target_filename, read.csv))
# Extract model from file names (fifth segment) and bind to experiment data frame
models <- sapply(strsplit(target_filename, "[-.]+"),function(x) x[5])
rep_models <- rep(models, each = 4) # four years
no_so4$model <- rep_models
# Take the average over all years for each variable
no_so4_summary <- no_so4 %>% dplyr::group_by(variable, model) %>%
dplyr::summarise(no_so4 = mean(value))
# Convert SO2 volume mixing ratio to mass mixing ratio by multiplying by molar mass
# of SO2 and dividing by molar mass of air
no_so4_summary$no_so4[which(no_so4_summary$variable == "so2")] = no_so4_summary$no_so4[which(no_so4_summary$variable == "so2")] * 64.066 / 28.96
#---------------------------------------------------
# Setup directory for SO2-at-height difference data
setwd(paste0('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP/input/', region, '/so2-at-hgt/diff'))
# Read in csv files and bind into single data frame
target_filename <- list.files(getwd(), "*.csv")
so2_at_hgt <- bind_rows(map(target_filename, read.csv))
# Extract model from file names (fifth segment) and bind to experiment data frame
models <- sapply(strsplit(target_filename, "[-.]+"),function(x) x[5])
rep_models <- rep(models, each = 4) # four years
so2_at_hgt$model <- rep_models
# Take the average over all years for each variable
so2_at_hgt_summary <- so2_at_hgt %>% dplyr::group_by(variable, model) %>%
dplyr::summarise(so2_at_hgt = mean(value))
# Convert SO2 volume mixing ratio to mass mixing ratio by multiplying by molar mass
# of SO2 and dividing by molar mass of air
so2_at_hgt_summary$so2_at_hgt[which(so2_at_hgt_summary$variable == "so2")] = so2_at_hgt_summary$so2_at_hgt[which(so2_at_hgt_summary$variable == "so2")] * 64.066 / 28.96
#---------------------------------------------------
# Setup directory for SO2-no-season difference data
setwd(paste0('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP/input/', region, '/so2-no-seas/diff'))
# Read in csv files and bind into single data frame
target_filename <- list.files(getwd(), "*.csv")
so2_no_seas <- bind_rows(map(target_filename, read.csv))
# Extract model from file names (fifth segment) and bind to experiment data frame
models <- sapply(strsplit(target_filename, "[-.]+"),function(x) x[5])
rep_models <- rep(models, each = 4) # four years
so2_no_seas$model <- rep_models
# Take the average over all years for each variable
so2_no_seas_summary <- so2_no_seas %>% dplyr::group_by(variable, model) %>%
dplyr::summarise(so2_no_seas = mean(value))
# Convert SO2 volume mixing ratio to mass mixing ratio by multiplying by molar mass
# of SO2 and dividing by molar mass of air
so2_no_seas_summary$so2_no_seas[which(so2_no_seas_summary$variable == "so2")] = so2_no_seas_summary$so2_no_seas[which(so2_no_seas_summary$variable == "so2")] * 64.066 / 28.96
#---------------------------------------------------
# Bind data together
summary_data <- list(bc_no_seas_summary, high_so4_summary, no_so4_summary, so2_at_hgt_summary, so2_no_seas_summary) %>% reduce(left_join, by = c("variable", "model"))
# Remove CESM2 for now due to noisy data
#summary_data <- dplyr::filter(summary_data, !(model == "CESM2"))
# Correct model names for CESM and CESM2
summary_data$model[which(summary_data$model == "CESM")] <- "CESM1"
#summary_data$model[which(summary_data$model == "CESM2")] <- "CESM2-WACCM6"
# Change to long format
summary_long <- summary_data %>% gather(experiment, value, -c(model, variable)) %>%
drop_na()
# Generate plots
title_font <- 9.5
axis_font <- 9
axis_title_font <- 9
emibc <- dplyr::filter(summary_long, variable == "emibc")
emibc_plot <- ggplot(emibc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface flux of BC - ', region), y="emibc (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(emibc$value)), max(abs(emibc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
emiso2 <- dplyr::filter(summary_long, variable == "emiso2")
emiso2_plot <- ggplot(emiso2, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface flux of SO2 - ', region), y="emiso2 (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(emiso2$value)), max(abs(emiso2$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
mmrbc <- dplyr::filter(summary_long, variable == "mmrbc")
mmrbc_plot <- ggplot(mmrbc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface concentration of BC - ', region), y="mmrbc (kg kg-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(mmrbc$value)), max(abs(mmrbc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
mmrso4 <- dplyr::filter(summary_long, variable == "mmrso4")
mmrso4_plot <- ggplot(mmrso4, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface concentration of SO4 - ', region), y="mmrso4 (kg kg-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(mmrso4$value)), max(abs(mmrso4$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
so2 <- dplyr::filter(summary_long, variable == "so2")
so2_plot <- ggplot(so2, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface concentration of SO2 - ', region), y="so2 (kg kg-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(so2$value)), max(abs(so2$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rlut <- dplyr::filter(summary_long, variable == "rlut")
rlut_plot <- ggplot(rlut, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('upwelling longwave flux \n at TOA - ', region), y="rlut (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(rlut$value)), max(abs(rlut$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rsut <- dplyr::filter(summary_long, variable == "rsut")
rsut_plot <- ggplot(rsut, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('upwelling shortwave flux \n at TOA - ', region), y="rsut (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(rsut$value)), max(abs(rsut$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rsdt <- dplyr::filter(summary_long, variable == "rsdt")
rsdt_plot <- ggplot(rsdt, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('incident shortwave flux \n at TOA - ', region), y="rsdt (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(rsdt$value)), max(abs(rsdt$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rlutcs <- dplyr::filter(summary_long, variable == "rlutcs")
rlutcs_plot <- ggplot(rlutcs, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('upwelling clear-sky longwave \n flux at TOA - ', region), y="rlutcs (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::number_format(accuracy = 0.01), limits = c(-max(abs(rlutcs$value)), max(abs(rlutcs$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rsutcs <- dplyr::filter(summary_long, variable == "rsutcs")
rsutcs_plot <- ggplot(rsutcs, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('upwelling clear-sky shortwave \n flux at TOA - ', region), y="rsutcs (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(rsutcs$value)), max(abs(rsutcs$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
# Define normal and clear-sky net radiative flux (sum of longwave and shortwave radiation)
net_rad <- dplyr::left_join(rlut, rsut, by = c("model", "experiment"))
net_rad <- dplyr::mutate(net_rad, value = value.x + value.y) %>%
dplyr::select(c(model, experiment, value))
net_rad_cs <- dplyr::left_join(rlutcs, rsutcs, by = c("model", "experiment"))
net_rad_cs <- dplyr::mutate(net_rad_cs, value = value.x + value.y) %>%
dplyr::select(c(model, experiment, value))
net_rad_plot <- ggplot(net_rad, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('net radiative flux at TOA - ', region), y="rlut + rsut (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(net_rad$value)), max(abs(net_rad$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
net_rad_cs_plot <- ggplot(net_rad_cs, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('clear-sky net radiative flux at TOA - ', region), y="rlutcs + rsutcs (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(net_rad_cs$value)), max(abs(net_rad_cs$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
drybc <- dplyr::filter(summary_long, variable == "drybc")
drybc_plot <- ggplot(drybc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('dry deposition rate of BC - ', region), y="drybc (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(drybc$value)), max(abs(drybc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
wetbc <- dplyr::filter(summary_long, variable == "wetbc")
wetbc_plot <- ggplot(wetbc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('wet deposition rate of BC - ', region), y="wetbc (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(wetbc$value)), max(abs(wetbc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
totbc <- dplyr::left_join(drybc, wetbc, by = c("model", "experiment"))
totbc <- dplyr::mutate(totbc, value = value.x + value.y) %>%
dplyr::select(c(model, experiment, value))
totbc_plot <- ggplot(tot_bc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('total deposition rate of BC - ', region), y="drybc + wetbc (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(totbc$value)), max(abs(totbc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
library(dplyr)
library(tidyr)
library(purrr)
library(ggplot2)
library(gridExtra)
library(grid)
# Define region (i.e., global, land, sea)
region <- "s-sea"
# Setup directory for bc-no-seas difference data
setwd(paste0('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP/input/', region, '/bc-no-seas/diff'))
# Read in csv files and bind into single data frame
target_filename <- list.files(getwd(), "*.csv")
bc_no_seas <- bind_rows(map(target_filename, read.csv))
# Extract model from file names (fifth segment) and bind to experiment data frame
models <- sapply(strsplit(target_filename, "[-.]+"),function(x) x[5])
rep_models <- rep(models, each = 4) # four years
bc_no_seas$model <- rep_models
# Take the average over all years for each variable
bc_no_seas_summary <- bc_no_seas %>% dplyr::group_by(variable, model) %>%
dplyr::summarise(bc_no_seas = mean(value))
# Convert SO2 volume mixing ratio to mass mixing ratio by multiplying by molar mass
# of SO2 and dividing by molar mass of air
bc_no_seas_summary$bc_no_seas[which(bc_no_seas_summary$variable == "so2")] = bc_no_seas_summary$bc_no_seas[which(bc_no_seas_summary$variable == "so2")] * 64.066 / 28.96
#---------------------------------------------------
# Setup directory for high-SO4 difference data
setwd(paste0('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP/input/', region, '/high-SO4/diff'))
# Read in csv files and bind into single data frame
target_filename <- list.files(getwd(), "*.csv")
high_so4 <- bind_rows(map(target_filename, read.csv))
# Extract model from file names (fifth segment) and bind to experiment data frame
models <- sapply(strsplit(target_filename, "[-.]+"),function(x) x[5])
rep_models <- rep(models, each = 4) # four years
high_so4$model <- rep_models
# Take the average over all years for each variable
high_so4_summary <- high_so4 %>% dplyr::group_by(variable, model) %>%
dplyr::summarise(high_so4 = mean(value))
# Convert SO2 volume mixing ratio to mass mixing ratio by multiplying by molar mass
# of SO2 and dividing by molar mass of air
high_so4_summary$high_so4[which(high_so4_summary$variable == "so2")] = high_so4_summary$high_so4[which(high_so4_summary$variable == "so2")] * 64.066 / 28.96
#---------------------------------------------------
# Setup directory for no-SO4 difference data
setwd(paste0('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP/input/', region, '/no-SO4/diff'))
# Read in csv files and bind into single data frame
target_filename <- list.files(getwd(), "*.csv")
no_so4 <- bind_rows(map(target_filename, read.csv))
# Extract model from file names (fifth segment) and bind to experiment data frame
models <- sapply(strsplit(target_filename, "[-.]+"),function(x) x[5])
rep_models <- rep(models, each = 4) # four years
no_so4$model <- rep_models
# Take the average over all years for each variable
no_so4_summary <- no_so4 %>% dplyr::group_by(variable, model) %>%
dplyr::summarise(no_so4 = mean(value))
# Convert SO2 volume mixing ratio to mass mixing ratio by multiplying by molar mass
# of SO2 and dividing by molar mass of air
no_so4_summary$no_so4[which(no_so4_summary$variable == "so2")] = no_so4_summary$no_so4[which(no_so4_summary$variable == "so2")] * 64.066 / 28.96
#---------------------------------------------------
# Setup directory for SO2-at-height difference data
setwd(paste0('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP/input/', region, '/so2-at-hgt/diff'))
# Read in csv files and bind into single data frame
target_filename <- list.files(getwd(), "*.csv")
so2_at_hgt <- bind_rows(map(target_filename, read.csv))
# Extract model from file names (fifth segment) and bind to experiment data frame
models <- sapply(strsplit(target_filename, "[-.]+"),function(x) x[5])
rep_models <- rep(models, each = 4) # four years
so2_at_hgt$model <- rep_models
# Take the average over all years for each variable
so2_at_hgt_summary <- so2_at_hgt %>% dplyr::group_by(variable, model) %>%
dplyr::summarise(so2_at_hgt = mean(value))
# Convert SO2 volume mixing ratio to mass mixing ratio by multiplying by molar mass
# of SO2 and dividing by molar mass of air
so2_at_hgt_summary$so2_at_hgt[which(so2_at_hgt_summary$variable == "so2")] = so2_at_hgt_summary$so2_at_hgt[which(so2_at_hgt_summary$variable == "so2")] * 64.066 / 28.96
#---------------------------------------------------
# Setup directory for SO2-no-season difference data
setwd(paste0('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP/input/', region, '/so2-no-seas/diff'))
# Read in csv files and bind into single data frame
target_filename <- list.files(getwd(), "*.csv")
so2_no_seas <- bind_rows(map(target_filename, read.csv))
# Extract model from file names (fifth segment) and bind to experiment data frame
models <- sapply(strsplit(target_filename, "[-.]+"),function(x) x[5])
rep_models <- rep(models, each = 4) # four years
so2_no_seas$model <- rep_models
# Take the average over all years for each variable
so2_no_seas_summary <- so2_no_seas %>% dplyr::group_by(variable, model) %>%
dplyr::summarise(so2_no_seas = mean(value))
# Convert SO2 volume mixing ratio to mass mixing ratio by multiplying by molar mass
# of SO2 and dividing by molar mass of air
so2_no_seas_summary$so2_no_seas[which(so2_no_seas_summary$variable == "so2")] = so2_no_seas_summary$so2_no_seas[which(so2_no_seas_summary$variable == "so2")] * 64.066 / 28.96
#---------------------------------------------------
# Bind data together
summary_data <- list(bc_no_seas_summary, high_so4_summary, no_so4_summary, so2_at_hgt_summary, so2_no_seas_summary) %>% reduce(left_join, by = c("variable", "model"))
# Remove CESM2 for now due to noisy data
#summary_data <- dplyr::filter(summary_data, !(model == "CESM2"))
# Correct model names for CESM and CESM2
summary_data$model[which(summary_data$model == "CESM")] <- "CESM1"
#summary_data$model[which(summary_data$model == "CESM2")] <- "CESM2-WACCM6"
# Change to long format
summary_long <- summary_data %>% gather(experiment, value, -c(model, variable)) %>%
drop_na()
# Generate plots
title_font <- 9.5
axis_font <- 9
axis_title_font <- 9
emibc <- dplyr::filter(summary_long, variable == "emibc")
emibc_plot <- ggplot(emibc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface flux of BC - ', region), y="emibc (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(emibc$value)), max(abs(emibc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
emiso2 <- dplyr::filter(summary_long, variable == "emiso2")
emiso2_plot <- ggplot(emiso2, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface flux of SO2 - ', region), y="emiso2 (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(emiso2$value)), max(abs(emiso2$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
mmrbc <- dplyr::filter(summary_long, variable == "mmrbc")
mmrbc_plot <- ggplot(mmrbc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface concentration of BC - ', region), y="mmrbc (kg kg-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(mmrbc$value)), max(abs(mmrbc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
mmrso4 <- dplyr::filter(summary_long, variable == "mmrso4")
mmrso4_plot <- ggplot(mmrso4, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface concentration of SO4 - ', region), y="mmrso4 (kg kg-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(mmrso4$value)), max(abs(mmrso4$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
so2 <- dplyr::filter(summary_long, variable == "so2")
so2_plot <- ggplot(so2, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('surface concentration of SO2 - ', region), y="so2 (kg kg-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(so2$value)), max(abs(so2$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rlut <- dplyr::filter(summary_long, variable == "rlut")
rlut_plot <- ggplot(rlut, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('upwelling longwave flux \n at TOA - ', region), y="rlut (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(rlut$value)), max(abs(rlut$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rsut <- dplyr::filter(summary_long, variable == "rsut")
rsut_plot <- ggplot(rsut, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('upwelling shortwave flux \n at TOA - ', region), y="rsut (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(rsut$value)), max(abs(rsut$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rsdt <- dplyr::filter(summary_long, variable == "rsdt")
rsdt_plot <- ggplot(rsdt, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('incident shortwave flux \n at TOA - ', region), y="rsdt (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(rsdt$value)), max(abs(rsdt$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rlutcs <- dplyr::filter(summary_long, variable == "rlutcs")
rlutcs_plot <- ggplot(rlutcs, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('upwelling clear-sky longwave \n flux at TOA - ', region), y="rlutcs (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::number_format(accuracy = 0.01), limits = c(-max(abs(rlutcs$value)), max(abs(rlutcs$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
rsutcs <- dplyr::filter(summary_long, variable == "rsutcs")
rsutcs_plot <- ggplot(rsutcs, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('upwelling clear-sky shortwave \n flux at TOA - ', region), y="rsutcs (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(rsutcs$value)), max(abs(rsutcs$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
# Define normal and clear-sky net radiative flux (sum of longwave and shortwave radiation)
net_rad <- dplyr::left_join(rlut, rsut, by = c("model", "experiment"))
net_rad <- dplyr::mutate(net_rad, value = value.x + value.y) %>%
dplyr::select(c(model, experiment, value))
net_rad_cs <- dplyr::left_join(rlutcs, rsutcs, by = c("model", "experiment"))
net_rad_cs <- dplyr::mutate(net_rad_cs, value = value.x + value.y) %>%
dplyr::select(c(model, experiment, value))
net_rad_plot <- ggplot(net_rad, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('net radiative flux at TOA - ', region), y="rlut + rsut (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(net_rad$value)), max(abs(net_rad$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
net_rad_cs_plot <- ggplot(net_rad_cs, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('clear-sky net radiative flux at TOA - ', region), y="rlutcs + rsutcs (W m-2)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(limits = c(-max(abs(net_rad_cs$value)), max(abs(net_rad_cs$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
drybc <- dplyr::filter(summary_long, variable == "drybc")
drybc_plot <- ggplot(drybc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('dry deposition rate of BC - ', region), y="drybc (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(drybc$value)), max(abs(drybc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
wetbc <- dplyr::filter(summary_long, variable == "wetbc")
wetbc_plot <- ggplot(wetbc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('wet deposition rate of BC - ', region), y="wetbc (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(wetbc$value)), max(abs(wetbc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
totbc <- dplyr::left_join(drybc, wetbc, by = c("model", "experiment"))
totbc <- dplyr::mutate(totbc, value = value.x + value.y) %>%
dplyr::select(c(model, experiment, value))
totbc_plot <- ggplot(totbc, aes(x = experiment, y = value, color = model)) +
theme_bw() +
labs(title=paste0('total deposition rate of BC - ', region), y="drybc + wetbc (kg m-2 s-1)") +
theme(plot.title = element_text(hjust = 0.5, size = title_font),
axis.text = element_text(size = axis_font),
axis.title = element_text(size = axis_title_font),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank()) +
scale_y_continuous(labels = scales::scientific_format(digits = 2), limits = c(-max(abs(totbc$value)), max(abs(totbc$value)))) +
geom_point( position=position_dodge(width=0.4), size = 1.5)
View(totbc)
View(wetbc)
View(drybc)
dryso2 <- dplyr::filter(summary_long, variable == "dryso2")
View(dryso2)
