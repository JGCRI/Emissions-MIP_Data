source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_diff.R', echo=TRUE)
perts
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
# Specify region (i.e., global, land, sea, arctic, NH-land, NH-sea, SH-land, SH-sea,
# NH-pacific, NH-atlantic)
region <- "NH-land"
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/timeseries_per_diff.R', echo=TRUE)
# ------------------------------------------------------------------------------
# Program Name: summary_plots_diff.R
# Authors: Hamza Ahsan
# Date Last Modified: Sept 3, 2021
# Program Purpose: Produces summary plots of the difference between the
# perturbations and the reference case averaged over all years
# Input Files: ~Emissions-MIP/input/
# Output Files: ~Emissions-MIP/output/
# TODO:
# ------------------------------------------------------------------------------
# Load required libraries
library(dplyr)
library(tidyr)
library(purrr)
library(ggplot2)
library(gridExtra)
library(grid)
# Specify location of Emissions-MIP directory
emi_dir <- paste0('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b')
# Specify region (i.e., global, land, sea, arctic, NH-land, NH-sea, SH-land, SH-sea,
# NH-pacific, NH-atlantic)
region <- "global"
# Define default ggplot colors and associate with models (in case a plot is
# missing a model, the color scheme will remain consistent)
gg_color_hue <- function(n) {
hues = seq(15, 375, length = n + 1)
hcl(h = hues, l = 65, c = 100)[1:n]
}
cols = gg_color_hue(5)
model_colors <- c("CESM1" = cols[1], "GISS" = cols[2], "GISS (all em)" = cols[3],
"GISS (SO2)" = cols[4])
# ------------------------------------------------------------------------------
# Setup directory for shp-10p-red difference data
setwd(paste0(emi_dir, '/input/', region, '/shp-10p-red/diff'))
# Read in csv files and bind into single data frame
target_filename <- list.files(getwd(), "*.csv")
shp_10p_red <- bind_rows(map(target_filename, read.csv))
# Extract model from file names (fifth segment) and bind to experiment data frame
models <- sapply(strsplit(target_filename, "[-.]+"),function(x) x[5])
rep_models <- rep(models, each = 5) # five years
shp_10p_red$model <- rep_models
View(shp_10p_red)
# Take the average over all years for each variable
shp_10p_red_summary <- shp_10p_red %>% dplyr::group_by(variable, model) %>%
dplyr::summarise(shp_10p_red = mean(value))
# Convert SO2 volume mixing ratio to mass mixing ratio by multiplying by molar mass
# of SO2 and dividing by molar mass of air
shp_10p_red_summary$shp_10p_red[which(shp_10p_red_summary$variable == "so2")] = shp_10p_red_summary$shp_10p_red[which(shp_10p_red_summary$variable == "so2")] * 64.066 / 28.96
View(shp_10p_red_summary)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
View(summary_data)
View(shp_ind_shift_1950_summary)
View(shp_20p_red_summary)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
View(summary_data)
View(summary_data)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
source('C:/Users/ahsa361/OneDrive - PNNL/Desktop/Emissions-MIP-Phase1b/code/summary_plots_per_diff.R', echo=TRUE)
